---
phase: 03-edge-cases-best-practices
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/polymarket/edge-cases/README.md
  - skills/polymarket/edge-cases/usdc-token-confusion.md
  - skills/polymarket/edge-cases/order-constraints.md
autonomous: true

must_haves:
  truths:
    - "User can diagnose whether they have USDC.e or Native USDC"
    - "User can resolve Native USDC situation with swap instructions"
    - "User can verify minimum order requirements before placement"
    - "User can correctly apply precision rules for each order type"
  artifacts:
    - path: "skills/polymarket/edge-cases/README.md"
      provides: "Edge cases index and navigation"
      min_lines: 40
    - path: "skills/polymarket/edge-cases/usdc-token-confusion.md"
      provides: "USDC.e vs Native USDC troubleshooting"
      contains: "0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"
    - path: "skills/polymarket/edge-cases/order-constraints.md"
      provides: "Order minimums, precision, tick size rules"
      contains: "ROUNDING_CONFIG"
  key_links:
    - from: "skills/polymarket/edge-cases/README.md"
      to: "skills/polymarket/edge-cases/usdc-token-confusion.md"
      via: "index link"
      pattern: "usdc-token-confusion"
    - from: "skills/polymarket/edge-cases/order-constraints.md"
      to: "skills/polymarket/trading/order-types.md"
      via: "reference link"
      pattern: "order-types"
---

<objective>
Create edge cases documentation for token confusion and order constraints, establishing the edge-cases directory structure.

Purpose: These are the two most common integration failures - wrong USDC token and precision/minimum rejections. Documenting symptoms-to-solutions prevents hours of debugging.

Output: edge-cases/README.md, edge-cases/usdc-token-confusion.md, edge-cases/order-constraints.md
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-edge-cases-best-practices/03-RESEARCH.md

# Existing documentation to reference (not duplicate)
@skills/polymarket/auth/token-allowances.md
@skills/polymarket/trading/order-types.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create edge-cases README and USDC token confusion guide</name>
  <files>
    skills/polymarket/edge-cases/README.md
    skills/polymarket/edge-cases/usdc-token-confusion.md
  </files>
  <action>
Create edge-cases/README.md as index:
- Title: "Edge Cases & Common Pitfalls"
- Quick symptom-to-solution table (link to each doc)
- Navigation to all edge case documents
- Link back to main skills index

Create edge-cases/usdc-token-confusion.md (EDGE-01):
- Title: "USDC.e vs Native USDC Confusion"
- Symptoms section: Polygon shows balance but Polymarket shows $0.00
- Root cause: exchanges default to Native USDC (0x3c499c...) not USDC.e (0x2791Bca...)
- Detection: Include `check_usdc_balances()` diagnostic function from research
- Solutions:
  1. Polymarket UI "Activate Funds" auto-swap
  2. Manual DEX swap (QuickSwap/Uniswap)
  3. Correct deposit next time (USDC.e withdrawal or bridge)
- Reference token-allowances.md for allowance setup after getting correct token
- Contract addresses table for reference

Focus on troubleshooting flow: symptom -> diagnosis -> fix. Do NOT duplicate the allowance setup code from token-allowances.md - reference it.
  </action>
  <verify>
Files exist at skills/polymarket/edge-cases/README.md and usdc-token-confusion.md.
README contains links to all planned edge case docs.
usdc-token-confusion.md contains both contract addresses and diagnostic code.
  </verify>
  <done>
Edge cases directory created with README index and USDC confusion guide that enables users to diagnose and fix the most common funding issue.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create order constraints comprehensive guide</name>
  <files>skills/polymarket/edge-cases/order-constraints.md</files>
  <action>
Create edge-cases/order-constraints.md combining EDGE-02, EDGE-03, EDGE-08:

**Order Minimums (EDGE-02):**
- Minimum order: Note that orderbook has no enforced minimum
- Practical minimums: discuss dust orders and gas efficiency
- Rewards threshold if relevant

**Decimal Precision Requirements (EDGE-03):**
- FOK requirements: maker amount 2 decimals, taker 4 decimals, product 2 decimals
- GTC/GTD: more lenient but must align to tick size
- Include `prepare_fok_order()` precision helper from research
- Error message: "invalid amounts, the sell orders maker amount supports a max accuracy of 2 decimals"
- Recovery: round size, fall back to GTC if precision impossible

**Dynamic Tick Size (EDGE-08):**
- Standard: 0.01 tick size
- At price extremes (>0.96 or <0.04): tick size decreases
- Include ROUNDING_CONFIG dictionary from research
- Pattern: always fetch tick size before order with `client.get_tick_size(token_id)`
- WebSocket: handle `tick_size_change` events
- Warning: don't cache tick sizes for long periods

**Decision Tree:**
Create visual decision flow for precision handling:
- If FOK: round to 2 decimals, check product, fall back to GTC if impossible
- If GTC/GTD: align to tick size
- Always fetch current tick size before order

Reference order-types.md for order type selection - this doc focuses on CONSTRAINTS not types.
  </action>
  <verify>
File exists at skills/polymarket/edge-cases/order-constraints.md.
Contains ROUNDING_CONFIG table.
Contains prepare_fok_order helper function.
References order-types.md for order type details.
  </verify>
  <done>
Order constraints guide covers minimums (EDGE-02), precision (EDGE-03), and tick sizes (EDGE-08) with actionable patterns that prevent order rejections.
  </done>
</task>

</tasks>

<verification>
- [ ] edge-cases/README.md exists with index of edge cases
- [ ] edge-cases/usdc-token-confusion.md exists with diagnostic code and solutions
- [ ] edge-cases/order-constraints.md exists with precision helpers and ROUNDING_CONFIG
- [ ] All files reference existing Phase 2 documentation where appropriate
- [ ] No duplicate code from existing documentation
</verification>

<success_criteria>
1. User encountering "Polymarket shows $0.00" can diagnose USDC type and swap
2. User encountering "invalid amounts" can apply precision fix or fall back
3. User can determine correct tick size before any order placement
4. EDGE-01, EDGE-02, EDGE-03, EDGE-08 requirements satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/03-edge-cases-best-practices/03-01-SUMMARY.md`
</output>
